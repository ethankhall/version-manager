= Conrad User Guide
Ethan Hall;
:doctype: book
:icons: font
:source-highlighter: highlightjs
:toc: left
:toclevels: 3
:sectlinks:

[introduction]
= Introduction

This provides documentation for Conrad, a project version management API. Conrad uses a project/repository hierarchy allowing to projects to define user(s) that can manage the API but giving the administrators the ability to add users as needed.

[terminology]
== Terminology

[[basic-terminology]]
.Basic Terminology
[cols="1s,3", options="header"]
|===
| Phrase
| Definition

| Project
| A project contains multiple repositories. The project allows the administrators to define users that have access and give permissions for all of the repositories this project contains.

| Repository
| A repository is a specific item that wants to be versioned. In most cases this will be a scm repository like git, mercurial, or svn. A repository can have additional users added to it, with their own permissions. Any definition in project overrides a value defined in the repository. Every repository contains Versions.

| Version
| A version is a mapping to commitId (git sha, svn id) to version numbers. These versions are final. You are not able to remove versions once created. Versions contain multiple sub-components that can be updated. Those components are "metadata", and "status".

[[basic-terminology-version-metadata]]
| Version Metadata
| A version can contain multiple arbitrary binary blobs. These binary blobs are currently limited to 10Kb and limited to 5 per version under the free projects. A metadata object can be updated once created unless the repository is configured to write only.

| Version Status
a| A version can be in one of 4 statuses, Pre-Release, Live, Deprecated, and Removed. For more details on these states and their transitions please read <<version-state-transitions>>
|===


=== Versions States
A version can be in one of 4 states, each version is independent of all other versions in the repository. The beginning state of any version can be either <<version-state-transitions-pre-release,Pre-Release>> or <<version-state-transitions-live,Live>>. As the version transitions to different states, it will eventually end up in <<version-state-transitions-removed,Removed>>. Once in Removed, the version cannot be moved to another state except by a repository administrator.

Version transitions can only be made by users with write access to the repository.

[[version-state-transitions]]
.Version State Transitions
[cols="1s,2,2,2", options="header"]
|====
| Name
| Description
| Transitions
| Notes

[[version-state-transitions-pre-release]]
| Pre-Release
| Implies that someone who consumes this repository should not use this version yet. You might want to use this version when you need to claim a version, but haven't uploaded artifacts yet. When the version API is queried  with "latest", a version in "Pre-Release" status will not be considered by default.
| Can move into any other state.
|

[[version-state-transitions-live]]
| Live
| This version is available for use
| Can move into either Deprecated or Removed state. It is recommended to move into Deprecated for a period of time before moving to Removed.
|

[[version-state-transitions-deprecated]]
| Deprecated
| This version is available for use but this is deprecated and not recommended to be used.
| Can move to Live or Removed.
| A deprecated version may have an auto remove date assigned to it when it will be automatically moved into Removed.

[[version-state-transitions-removed]]
| Removed
| This version is no longer available for use and you must migrate to a different version.
| None
| This is a final state and can-not be moved without repository administrator <<repository-permissions-user,permissions>>.
|====

[[repository-permissions]]
=== Permissions

[[repository-permissions-user]]
.User Repository Permissions
[cols="1s,2,2", options="header"]
|===
| Name
| Description
| Notes

| None
| This is the default permission for every user, depending on the repository configuration this may prevent others from accessing the project entirely.
|

| Read
| This gives the user access to read all information about the repository. This includes <<basic-terminology-version-metadata,metadata>>.
|

| Update
| This gives the user the ability to write / update states for a version as well as the metadata.
| In some cases the repository may be configured to allow only writes to the metadata, when this is set, an update will be rejected from the user.

| Administrator
| This user is able to update other user permissions as well as all the previous permissions. This user is allowed to transition a version from <<version-state-transitions-removed,Removed>> to <<version-state-transitions-live,Live>> or <<version-state-transitions-deprecated,Deprecated>>.
| Administrators may over write metadata even when set to write only. The previous version will be kept and given a new name.

|===


[resources]
= Resources

[[resources-project]]
== Project

The project is the root element that every repository. Check out the API docs link:api/project/index.html[here].


[[resources-repository]]
== Repository

A repository contains versions and details about the repository. The API docs are located link:api/repository/index.html[here]

[[resources-repository-versions]]
=== Versions
Given a repository, a sub-resource are versions. For details about the version sub-resource, in the link:api/repository/version/index.html[Version API docs].
